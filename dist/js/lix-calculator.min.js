var LixCalculator={};LixCalculator=LixCalculator||{},LixCalculator.Lix=LixCalculator.Lix||{},LixCalculator.Lix.Calculator=function(t){function e(){t(window).load(function(){this.bindEvents()}.bind(this)),t("#content-tmce, #content-html").on("click",function(){console.log("Rebind"),this.bindEvents()}.bind(this))}var n,o="#lix-calculator-content",a=500;return e.prototype.bindEvents=function(){if(0!==t("#content").length){var e,o;setTimeout(function(){tinymce.get("content")&&(e=tinymce.get("content"),e.off("keyup"),this.calculateAndOutput(e.getContent({format:"text"})),e.on("keyup",function(){clearTimeout(n),n=setTimeout(function(){this.calculateAndOutput(e.getContent({format:"text"}))}.bind(this),a)}.bind(this)))}.bind(this),1e3),o=t("textarea#content"),o.off("keyup"),this.calculateAndOutput(o.val().replace(/<\/?[^>]+(>|$)/g,"")),o.on("keyup",function(){clearTimeout(n),n=setTimeout(function(){this.calculateAndOutput(o.val().replace(/<\/?[^>]+(>|$)/g,""))}.bind(this),a)}.bind(this))}},e.prototype.calculateAndOutput=function(t){var e=this.parseText(t),n=this.calculate(e.words,e.longWords,e.sentences);this.getWordFrequency(t);this.output(n)},e.prototype.getWordFrequency=function(e){e=e.toLowerCase();var n=e.split(/[\s*\.*\,\;\+?\#\|:\-\/\\\[\]\(\)\{\}$%&0-9*]/),o=[];return t.each(n,function(t,e){e.length<2||(o[e]?o[e].count++:o[e]={word:e,count:1})}),o},e.prototype.parseText=function(t){return t?{characters:t.length,words:t.trim().match(/\S+/g).length,longWords:null!=t.trim().match(/(\S+){7,}/g)?t.trim().match(/[\S+]{7,}/g).length:0,sentences:t.trim().match(/([^\.\!\?]+[\.\?\!]*)/g).length}:{characters:0,words:0,longWords:0,sentences:0}},e.prototype.calculate=function(t,e,n){if(0==t)return LixCalculatorLang.na;var o=t/n+e/t*100;return o.toFixed(2)},e.prototype.getReadability=function(t){useParentheses="undefined"!=typeof useParentheses?useParentheses:!1,useColor="undefined"!=typeof useColor?useColor:!1;var e=LixCalculatorLang.na,n="#ddd",o="#000";return 30>t?(e=LixCalculatorLang.very_easy,n="#098400",o="#fff"):t>29&&41>t?(e=LixCalculatorLang.easy,n="#5DAE00",o="#fff"):t>40&&51>t?(e=LixCalculatorLang.moderate,n="#FFDC00",o="#000"):t>50&&61>t?(e=LixCalculatorLang.hard,n="#FF9600",o="#000"):t>60&&(e=LixCalculatorLang.very_hard,n="#FF1300",o="#fff"),{value:e,bgColor:n,textColor:o}},e.prototype.output=function(e){var n=this.getReadability(e);t(o).find(".value.lix").html(e).css({backgroundColor:n.bgColor,color:n.textColor}),t(o).find(".value.readability").html(n.value).css({backgroundColor:n.bgColor,color:n.textColor})},new e}(jQuery);