var LixCalculator=function(t){function a(){0!==t("#content").length&&t(window).load(function(){this.init()}.bind(this))}var o,l,r,n=t("#lix-calculator-content"),i=[],e=300;return a.prototype.init=function(){setTimeout(function(){tinymce.get("content")&&(l=tinymce.get("content"),l.off("keyup"),this.calculate("visual",this.trimContent(l.getContent({format:"text"}))),l.on("keyup",function(){clearTimeout(o),o=setTimeout(function(){this.calculate("visual",this.trimContent(l.getContent({format:"text"})))}.bind(this),e)}.bind(this)))}.bind(this),1e3),r=t("textarea#content"),r.off("keyup"),this.calculate("text",this.trimContent(r.val())),r.on("keyup",function(){clearTimeout(o),o=setTimeout(function(){this.calculate("text",this.trimContent(r.val()))}.bind(this),e)}.bind(this))},a.prototype.trimContent=function(t){return t=t.replace(/<\/?[^>]+(>|$)/g,""),t=t.replace(/\t/g,"")},a.prototype.calculate=function(o,l){"undefined"!=typeof a.Formula&&a.Formula.Total.resetTotal(),t.each(i,function(t,a){a.obj.init(l)}.bind(this))},a.prototype.addFormula=function(a,o,l,r){"undefined"==typeof r&&(r=10);var e='<div class="col" id="lix-calculator-'+this.slugify(o)+'" data-priority="'+r+'">                <label>                    '+o+"                    <small>"+l+'</small>                </label>                <em class="value">'+LixCalculatorLang.na+'</em><br>                <span class="value">'+LixCalculatorLang.na+"</span>            </div>",u=n.find(".col").filter(function(){return parseInt(t(this).attr("data-priority"))<=r}).last();u.length?u.after(e):n.append(e),i.push({obj:a,title:o,description:l})},a.prototype.slugify=function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},a.prototype.getSentences=function(t){return t.trim().length>0?t.trim().match(/([^\.\!\?]+[\.\?\!]*)/g).length:0},new a}(jQuery);LixCalculator=LixCalculator||{},LixCalculator.Formula=LixCalculator.Formula||{},LixCalculator.Formula.Lix=function(t){function a(){LixCalculator.addFormula(this,LixCalculatorLang.lix.title,LixCalculatorLang.lix.description)}return a.prototype.init=function(t){var a=this.getParamsFromText(t),o=this.calculate(a.words,a.longWords,a.sentences),l=this.getReadability(o);this.output(o,l)},a.prototype.output=function(a,o){var l="#lix-calculator-"+LixCalculator.slugify(LixCalculatorLang.lix.title);LixCalculator.Formula.Total.appendTotal(100-a,100),a=100-a+"%",t(l).find("em.value").html(a).css({backgroundColor:o.bgColor,color:o.textColor}),t(l).find("span.value").html(o.value).css({backgroundColor:o.bgColor,color:o.textColor})},a.prototype.getReadability=function(t){var a=LixCalculatorLang.na,o="#ddd",l="#000";return t<30?(a=LixCalculatorLang.lix.very_easy,o="#098400",l="#fff"):t>29&&t<41?(a=LixCalculatorLang.lix.easy,o="#5DAE00",l="#fff"):t>40&&t<51?(a=LixCalculatorLang.lix.moderate,o="#FFDC00",l="#000"):t>50&&t<61?(a=LixCalculatorLang.lix.hard,o="#FF9600",l="#000"):t>60&&(a=LixCalculatorLang.lix.very_hard,o="#FF1300",l="#fff"),{value:a,bgColor:o,textColor:l}},a.prototype.calculate=function(t,a,o){if(0===t)return LixCalculatorLang.na;var l=t/o+a/t*100;return l.toFixed(2)},a.prototype.getParamsFromText=function(t){return{words:t.trim().length>0&&null!==t.trim().match(/\S+/g)?t.trim().match(/\S+/g).length:0,longWords:t.trim().length>0&&null!==t.trim().match(/(\S+){7,}/g)?t.trim().match(/[\S+]{7,}/g).length:0,sentences:LixCalculator.getSentences(t)}},new a}(jQuery),LixCalculator=LixCalculator||{},LixCalculator.Formula=LixCalculator.Formula||{},LixCalculator.Formula.Paragraph=function(t){function a(){LixCalculator.addFormula(this,LixCalculatorLang.paragraph.title,LixCalculatorLang.paragraph.description)}return a.prototype.init=function(t){var a=this.getParamsFromText(t),o=this.calculate(a.sentences,a.paragraphs);this.output(o)},a.prototype.output=function(a){var o="#lix-calculator-"+LixCalculator.slugify(LixCalculatorLang.paragraph.title);if("NaN"==a)return void t(o).find(".value").html(LixCalculatorLang.na).attr("style","");var l="#5DAE00",r="#fff",n=LixCalculatorLang.paragraph.good;a<1&&(l="#FF1300",r="#fff",n=LixCalculatorLang.paragraph.low),a>=5&&(l="#FF1300",r="#fff",n=LixCalculatorLang.paragraph.high),console.log(a),a=(100*a).toFixed(2),a>100&&a<500&&(a=100),LixCalculator.Formula.Total.appendTotal(a,100),a+="%",t(o).find("em.value").html(a).css({backgroundColor:l,color:r}),t(o).find("span.value").html(n).css({backgroundColor:l,color:r})},a.prototype.calculate=function(t,a){var o=t/a;return o=o.toFixed(2)},a.prototype.getParamsFromText=function(t){return{sentences:LixCalculator.getSentences(t),paragraphs:t.trim().length>0?t.trim().split(/[\r\n][\r\n]+/).length:0}},new a}(jQuery),LixCalculator=LixCalculator||{},LixCalculator.Formula=LixCalculator.Formula||{},LixCalculator.Formula.Total=function(t){function a(){LixCalculator.addFormula(this,LixCalculatorLang.total.title,LixCalculatorLang.total.description,1e3)}var o=0,l=0,r=0;return a.prototype.init=function(t){},a.prototype.appendTotal=function(t,a){o+=t,l+=a,r=o/l*100,r=r.toFixed(2),this.output(r)},a.prototype.output=function(a){var o="#lix-calculator-"+LixCalculator.slugify("Total"),l="#f2b127",r="#fff",n=LixCalculatorLang.total.ok;a<40&&(l="#FF1300",r="#fff",n=LixCalculatorLang.total.bad),a>=60&&(l="#5DAE00",r="#fff",n=LixCalculatorLang.total.good),a+="%",t(o).find("em.value").html(a).css({backgroundColor:l,color:r}),t(o).find("span.value").html(n).css({backgroundColor:l,color:r})},a.prototype.resetTotal=function(){o=0,l=0,r=0},new a}(jQuery);