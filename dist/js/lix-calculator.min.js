var LixCalculator=function(t){function a(){0!==t("#content").length&&t(window).load(function(){this.init()}.bind(this))}var l,o,r,i=t("#lix-calculator-content"),n=[],e=300;return a.prototype.init=function(){setTimeout(function(){tinymce.get("content")&&(o=tinymce.get("content"),o.off("keyup"),this.calculate("visual",this.trimContent(o.getContent({format:"text"}))),o.on("keyup",function(){clearTimeout(l),l=setTimeout(function(){this.calculate("visual",this.trimContent(o.getContent({format:"text"})))}.bind(this),e)}.bind(this)))}.bind(this),1e3),r=t("textarea#content"),r.off("keyup"),this.calculate("text",this.trimContent(r.val())),r.on("keyup",function(){clearTimeout(l),l=setTimeout(function(){this.calculate("text",this.trimContent(r.val()))}.bind(this),e)}.bind(this))},a.prototype.trimContent=function(t){return t=t.replace(/<\/?[^>]+(>|$)/g,""),t=t.replace(/\t/g,"")},a.prototype.calculate=function(l,o){"undefined"!=typeof a.Formula&&a.Formula.Total.resetTotal(),t.each(n,function(t,a){a.obj.init(o)}.bind(this))},a.prototype.addFormula=function(a,l,o,r){"undefined"==typeof r&&(r=10);var e='<div class="col" id="lix-calculator-'+this.slugify(l)+'" data-priority="'+r+'">                <label>                    '+l+"                    <small>"+o+'</small>                </label>                <em class="value">'+LixCalculatorLang.na+'</em><br>                <span class="value">'+LixCalculatorLang.na+"</span>            </div>",u=i.find(".col").filter(function(){return parseInt(t(this).attr("data-priority"))<=r}).last();u.length?u.after(e):i.append(e),n.push({obj:a,title:l,description:o})},a.prototype.slugify=function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},a.prototype.getSentences=function(t){return t.trim().length>0?t.trim().match(/([^\.\!\?]+[\.\?\!]*)/g).length:0},new a}(jQuery);LixCalculator=LixCalculator||{},LixCalculator.Formula=LixCalculator.Formula||{},LixCalculator.Formula.Lix=function(t){function a(){LixCalculator.addFormula(this,LixCalculatorLang.lix.title,LixCalculatorLang.lix.description)}return a.prototype.init=function(t){var a=this.getParamsFromText(t),l=this.calculate(a.words,a.longWords,a.sentences),o=this.getReadability(l);this.output(l,o)},a.prototype.output=function(a,l){var o="#lix-calculator-"+LixCalculator.slugify(LixCalculatorLang.lix.title);LixCalculator.Formula.Total.appendTotal(100-a,100),a=100-a+"%",t(o).find("em.value").html(a).css({backgroundColor:l.bgColor,color:l.textColor}),t(o).find("span.value").html(l.value).css({backgroundColor:l.bgColor,color:l.textColor})},a.prototype.getReadability=function(t){var a=LixCalculatorLang.na,l="#ddd",o="#000";return t<30?(a=LixCalculatorLang.lix.very_easy,l="#098400",o="#fff"):t>29&&t<41?(a=LixCalculatorLang.lix.easy,l="#5DAE00",o="#fff"):t>40&&t<51?(a=LixCalculatorLang.lix.moderate,l="#FFDC00",o="#000"):t>50&&t<61?(a=LixCalculatorLang.lix.hard,l="#FF9600",o="#000"):t>60&&(a=LixCalculatorLang.lix.very_hard,l="#FF1300",o="#fff"),{value:a,bgColor:l,textColor:o}},a.prototype.calculate=function(t,a,l){if(0===t)return LixCalculatorLang.na;var o=t/l+a/t*100;return o.toFixed(2)},a.prototype.getParamsFromText=function(t){return{words:t.trim().length>0&&null!==t.trim().match(/\S+/g)?t.trim().match(/\S+/g).length:0,longWords:t.trim().length>0&&null!==t.trim().match(/(\S+){7,}/g)?t.trim().match(/[\S+]{7,}/g).length:0,sentences:LixCalculator.getSentences(t)}},new a}(jQuery),LixCalculator=LixCalculator||{},LixCalculator.Formula=LixCalculator.Formula||{},LixCalculator.Formula.Paragraph=function(t){function a(){LixCalculator.addFormula(this,LixCalculatorLang.paragraph.title,LixCalculatorLang.paragraph.description)}return a.prototype.init=function(t){var a=this.getParamsFromText(t),l=this.calculate(a.sentences,a.paragraphs);this.output(l)},a.prototype.output=function(a){var l="#lix-calculator-"+LixCalculator.slugify(LixCalculatorLang.paragraph.title);if("NaN"==a)return void t(l).find(".value").html(LixCalculatorLang.na).attr("style","");var o="#5DAE00",r="#fff",i=LixCalculatorLang.paragraph.good;a<1&&(o="#FF1300",r="#fff",i=LixCalculatorLang.paragraph.low),a>=5&&(o="#FF1300",r="#fff",i=LixCalculatorLang.paragraph.high),LixCalculator.Formula.Total.appendTotal(100*a,100),a=(100*a).toFixed(2)+"%",t(l).find("em.value").html(a).css({backgroundColor:o,color:r}),t(l).find("span.value").html(i).css({backgroundColor:o,color:r})},a.prototype.calculate=function(t,a){var l=t/a;return l=l.toFixed(2)},a.prototype.getParamsFromText=function(t){return{sentences:LixCalculator.getSentences(t),paragraphs:t.trim().length>0?t.trim().split(/[\r\n][\r\n]+/).length:0}},new a}(jQuery),LixCalculator=LixCalculator||{},LixCalculator.Formula=LixCalculator.Formula||{},LixCalculator.Formula.Total=function(t){function a(){LixCalculator.addFormula(this,LixCalculatorLang.total.title,LixCalculatorLang.total.description,1e3)}var l=0,o=0,r=0;return a.prototype.init=function(t){},a.prototype.appendTotal=function(t,a){l+=t,o+=a,r=l/o*100,r=r.toFixed(2),this.output(r)},a.prototype.output=function(a){var l="#lix-calculator-"+LixCalculator.slugify("Total"),o="#f2b127",r="#fff",i=LixCalculatorLang.total.ok;a<40&&(o="#FF1300",r="#fff",i=LixCalculatorLang.total.bad),a>=60&&(o="#5DAE00",r="#fff",i=LixCalculatorLang.total.good),a+="%",t(l).find("em.value").html(a).css({backgroundColor:o,color:r}),t(l).find("span.value").html(i).css({backgroundColor:o,color:r})},a.prototype.resetTotal=function(){l=0,o=0,r=0},new a}(jQuery);