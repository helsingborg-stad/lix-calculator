var LixCalculator={};LixCalculator=LixCalculator||{},LixCalculator.Lix=LixCalculator.Lix||{},LixCalculator.Lix.Calculator=function(t){function e(){this.bindEvents()}var o,n="#lix-calculator-content",r=500;return e.prototype.bindEvents=function(){t(window).load(function(){var t=tinymce.get("content");this.calculateAndOutput(t.getContent({format:"text"})),t.on("keyup",function(){clearTimeout(o),o=setTimeout(function(){this.calculateAndOutput(t.getContent({format:"text"}))}.bind(this),r)}.bind(this))}.bind(this))},e.prototype.calculateAndOutput=function(t){var e=this.parseText(t),o=this.calculate(e.words,e.longWords,e.sentences);this.getWordFrequency(t);this.output(o)},e.prototype.getWordFrequency=function(e){e=e.toLowerCase();var o=e.split(/[\s*\.*\,\;\+?\#\|:\-\/\\\[\]\(\)\{\}$%&0-9*]/),n=[];return t.each(o,function(t,e){e.length<2||(n[e]?n[e].count++:n[e]={word:e,count:1})}),n},e.prototype.parseText=function(t){return t?{characters:t.length,words:t.trim().match(/\S+/g).length,longWords:null!=t.trim().match(/(\S+){7,}/g)?t.trim().match(/[\S+]{7,}/g).length:0,sentences:t.trim().match(/([^\.\!\?]+[\.\?\!]*)/g).length}:{characters:0,words:0,longWords:0,sentences:0}},e.prototype.calculate=function(t,e,o){if(0==t)return"NA";var n=t/o+e/t*100;return n.toFixed(2)},e.prototype.getReadability=function(t){useParentheses="undefined"!=typeof useParentheses?useParentheses:!1,useColor="undefined"!=typeof useColor?useColor:!1;var e="NA",o="#ddd",n="#000";return 30>t?(e="Mycket lättläst",o="#098400",n="#fff"):t>29&&41>t?(e="Lättläst",o="#5DAE00",n="#fff"):t>40&&51>t?(e="Medelsvår",o="#FFDC00",n="#000"):t>50&&61>t?(e="Svårläst",o="#FF9600",n="#000"):t>60&&(e="Mycket svårläst",o="#FF1300",n="#fff"),{value:e,bgColor:o,textColor:n}},e.prototype.output=function(e){var o=this.getReadability(e);t(n).find(".value.lix").html(e).css({backgroundColor:o.bgColor,color:o.textColor}),t(n).find(".value.readability").html(o.value).css({backgroundColor:o.bgColor,color:o.textColor})},new e}(jQuery);